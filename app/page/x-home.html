<dom-module id="x-home">
	<template>
		<br>
		<br>
		<button onclick="enviarCpe()"> ennivar cpe </button>
		<button onclick="abrirToast()"> abrir toast </button>
		<!--bottom onclick="xUs()">aaaaaaaaaaaa</bottom>
		<bottom onclick="xUsExtraer()">traer Datos</bottom-->
		<div id="xBodyOp">
		</div>
		<!--div id="Div_op1">
			<h3>Operatividad</h3>
			<div class="xLinea2"></div><br>
			<div class="xMiBoton_icon xInvisible" id="btn_op11" data-id='A' data-op="2"><img src="../../images/_e_carta.png"><p>Elaborar Carta</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op12" data-id='B' data-op="3"><img src="../../images/_r_pedido.png"><p>Realizar Pedidos</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op13" data-id='C' data-op="8"><img src="../../images/_caja.png"><p>Caja</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op14" data-id='D' data-op="9"><img src="../../images/_c_pedido.png"><p>Control de pedidos</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op14" data-id='L' data-op="16"><img src="../../images/_venta_rapida.png"><p>Venta Rapida</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op14" data-id='O' data-op="19"><img src="../../images/_monitor_pedido.png"><p>Monitoreo del stock</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op14" data-id='P' data-op="20"><img src="../../images/x_historial_venta.png"><p>Registro de pagos</p>
		</div>
		<br>
		<div id="Div_op3">
			<h3>Logistica</h3>
			<div class="xLinea2"></div><br>
			<div class="xMiBoton_icon xInvisible" id="btn_op23" data-id='H' data-op="12"><img src="../../images/_compras.png"><p>Compras</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op23" data-id='I' data-op="13"><img src="../../images/_distribuicion.png"><p>Distribuicion</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op23" data-id='J' data-op="14"><img src="../../images/_porcionar.png"><p>Porcionar</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op23" data-id='K' data-op="15"><img src="../../images/_recetas.png"><p>Recetas y costos</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op23" data-id='M' data-op="17"><img src="../../images/_almacen_producto.png"><p>Productos Porciones</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op23" data-id='N' data-op="18"><img src="../../images/_ie_almacen.png"><p>Entradas y Salidas del almacen</p></div>
		</div>
		<br>
		<div id="Div_op2">
			<h3>Configuracion</h3>
			<div class="xLinea2"></div><br>
			<div class="xMiBoton_icon xInvisible" id="btn_op21" data-id='E' data-op="7"><img src="../../images/_config.png"><p>Datos del sistema</p></div>
			<div class="xMiBoton_icon xInvisible" id="btn_op22" data-id='F' data-op="6"><img src="../../images/_usuario.png"><p>Usuarios</p></div>
		</div-->
	</template>
</dom-module>
<script>
var xThis;
var xArray_us_home;
function xUs(){
	$.ajax({ type: 'POST', url: '../../bdphp/log.php?op=-1111'})
		.done( function (dt) {
			alert(dt)
			window.localStorage.setItem("::app3_woDUS", dt);
		})
}
function xUsExtraer(){
	XX=window.localStorage.getItem("::app3_woDUS")
	AA=window.atob(XX);
	xaa=JSON.parse(AA)
	alert(xaa)
}
function xIniHome(){
	//xVerificarSession();
//xm_LogChequea(function(){
		xLoadAcc();

		$("#panel_toolbar").show();
		$('body').addClass('loaded');
		// if(xIdOrg=='' || xIdOrg==undefined){xIdOrg=window.localStorage.getItem('::app3_wo');}
		// if(xIdUsuario=='' || xIdUsuario==undefined){xIdUsuario=window.localStorage.getItem('::app3_woU');}
		$("#Titulo_page").text("Inicio");
		xm_log_get('ini_us');
		xThis.xt_org=xIdOrg;
		xThis.xt_idsede=xIdSede;
		xThis.xt_idus=xIdUsuario;
	//});

	$(document).on('click','.xMiBoton_icon',function(e){
		var xop=$(this).attr('data-op');
		xOpenPage(xop);

		event.stopPropagation();
		e.stopPropagation();
		e.stopImmediatePropagation()
		return false;
	})
}
function xLoadAcc(){
		/*
	xArray_us_home=$.parseJSON(window.localStorage.getItem('::app3_Us_home'));
	if(xArray_us_home==undefined){
			$.ajax({ type: 'POST', url: '../../bdphp/log.php?op=-107'})
			.done( function (DtOp) {
				var xDtOp=$.parseJSON(DtOp);
				xArray_us_home=xDtOp.datos;
				window.localStorage.setItem("::app3_Us_home",JSON.stringify(xArray_us_home));
				xVerificarAcc();
			});
		}else{
			xVerificarAcc();
		}*/
		xVerificarAcc();
}

function xVerificarAcc(){
	xArray_us_home=xm_log_get('app3_Us_home');
	xper_bd=xm_log_get('app3_woA');
	//xLoadSetDatosSession(function(acc){
		//xper_bd=acc;
		var xCharAcc='';
		var xOpView=new Array();
		var xidGrupoBd;
		var xTituloSeccion;
		var xt;

		xper_bd=xper_bd.split(',')
		for (var i = 0; i < xper_bd.length; i++) {
			xCharFind=xper_bd[i];
			for (var z = 0; z < xArray_us_home.length; z++) {
				if(xArray_us_home[z].codigo==xCharFind){
					xidGrupoBd=xArray_us_home[z].idgrupo
					if(xOpView[xidGrupoBd]==undefined){
						switch(xidGrupoBd){
							case '0':xTituloSeccion='Operatividad'; break;
							case '1':xTituloSeccion='Logistica'; break;
							case '2':xTituloSeccion='Configuracion'; break;
						}
						xOpView[xidGrupoBd]={'titulo':xTituloSeccion};
					}
					xOpView[xidGrupoBd][i]={op:'<div class="xMiBoton_icon" data-id="'+xCharFind+'" data-op="'+xArray_us_home[z].num_opcion+'"><img src="../../images/'+xArray_us_home[z].img+'"><p>'+xArray_us_home[z].titulo+'</p></div>'};
				}
			};
		};

		var xHtmlOpView='';
		for (i in xOpView) {
			xHtmlOpView=String(xHtmlOpView+'<div><h3>'+xOpView[i].titulo+'</h3><div class="xLinea2"></div><br>')

			$.map(xOpView[i], function(n, z) {
				if (typeof n=="object"){
					xHtmlOpView=String(xHtmlOpView+xOpView[i][z].op);
				}
			})
			xHtmlOpView=String(xHtmlOpView+'</div><br>');
		};

		$("#xBodyOp").html(xHtmlOpView).trigger('create');
	//})
}

function abrirToast() {
	toast = document.getElementById('toast');
	toast.open();
}
	function enviarCpe() {
		const xjson =
		{
			"serie_documento": "B001",
			"numero_documento": "#",
			"fecha_de_emision": "2018-10-09",
			"hora_de_emision": "10:11:11",
			"codigo_tipo_operacion": "0101",
			"codigo_tipo_documento": "03",
			"codigo_tipo_moneda": "PEN",
			"fecha_de_vencimiento": "2018-08-30",
			"numero_orden_de_compra": "0045467898",
			"datos_del_emisor": {
				"codigo_pais": "PE",
				"ubigeo": "150101",
				"direccion": "Av. 2 de Mayo",
				"correo_electronico": "demo@gmail.com",
				"telefono": "427-1148",
				"codigo_del_domicilio_fiscal": "0000"
			},
			"datos_del_cliente_o_receptor": {
				"codigo_tipo_documento_identidad": "6",
				"numero_documento": "10414711225",
				"apellidos_y_nombres_o_razon_social": "EMPRESA XYZ S.A.",
				"codigo_pais": "PE",
				"ubigeo": "150101",
				"direccion": "Av. 2 de Mayo",
				"correo_electronico": "demo@gmail.com",
				"telefono": "427-1148"
			},
			"totales": {
				"total_exportacion": 0.00,
				"total_operaciones_gravadas": 0.00,
				"total_operaciones_inafectas": 0.00,
				"total_operaciones_exoneradas": 118.00,
				"total_operaciones_gratuitas": 0.00,
				"total_igv": 0.00,
				"total_impuestos": 0.00,
				"total_valor": 118,
				"total_venta": 118
			},
			"items": [
				{
					"codigo_interno": "P0121",
					"descripcion": "Inca Kola 250 ml",
					"codigo_producto_sunat": "51121703",
					"codigo_producto_gsl": "51121703",
					"unidad_de_medida": "NIU",
					"cantidad": 2,
					"valor_unitario": 59,
					"codigo_tipo_precio": "01",
					"precio_unitario": 59,
					"codigo_tipo_afectacion_igv": "20",
					"total_base_igv": 0.00,
					"porcentaje_igv": 18,
					"total_igv": 0.00,
					"total_impuestos": 0.00,
					"total_valor_item": 118,
					"total_item": 118
				}
			],
			"extras": {
				"forma_de_pago": "Efectivo",
				"observaciones": "probando",
				"vendedor": "Juan",
				"caja": "Caja 1"
			}
		}

		const _url = URL_COMPROBANTE + '/documents';
		let _headers = HEADERS_COMPROBANTE;
		_headers.Authorization = "Bearer 0SPvP3HY0qVzM00sCWZc40UCXh3DrObQhobGEzEWCrUOKwCyaX";

		const json_xml = JSON.stringify(xjson);

		// var myHeaders = new Headers();
		// myHeaders.append("X-My-Custom-Header", "some value");

		fetch(_url, {
			method: 'POST',
			headers: _headers,
			body: json_xml,
		}).then(function (response) {
			return response.json();
		}).then(function (json) {
			console.log(json);
		});

		// $.ajax({
		// 	type: "POST",
		// 	url: _url,
		// 	headers: _headers,
		// 	dataType: "json",
		// 	data: json_xml,		
		// 	success: function (data) {
		// 		console.log(data);
		// 	}
		// });

	}

Polymer({
	is:'x-home',
	properties:{
		xt_org:Number,
		xt_idsede:Number,
		xt_idus:Number
	},
	attached:function(){
    	xThis=this;
    	xIniHome();
    }
})
</script>
